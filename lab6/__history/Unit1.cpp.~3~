//---------------------------------------------------------------------------

#include <vcl.h>
#pragma hdrstop

#include "Unit1.h"
#include "Tree.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma resource "*.dfm"
TForm1 *Form1;

TTree *tree;
int n = 9;
// Доступ к удалению строки в стринггрид
class TExtStringGrid: public  TStringGrid
{
    public:
        using TStringGrid::DeleteRow;
};

void ViewTree(TTree *p, int kl)

{
	if (p == NULL) return;
	if (kl == -1)
		Form1->TreeView1->Items->AddFirst(NULL,p->Inf.fio+"= "+IntToStr(p->Inf.key));
	else
		Form1->TreeView1->Items->AddChildFirst(Form1->
	TreeView1->Items->Item[kl], p->Inf.fio+" = "+IntToStr(p->Inf.key));
	kl++;
	ViewTree(p->A1,kl);
	ViewTree(p->A2,kl);
	kl--;
}

void Search(TTree *p, int index)
{
if (p == NULL) return;

	if (p->Inf.key == index) {
		Form1->Memo1->Lines->Add(p->Inf.fio);
	}
	if (p->Inf.key > index) {
		Search(p->A1,index);
	}
	if (p->Inf.key < index ) {
		Search(p->A2,index);
	}
}
//---------------------------------------------------------------------------
__fastcall TForm1::TForm1(TComponent* Owner)
	: TForm(Owner)
{
}
//---------------------------------------------------------------------------

void __fastcall TForm1::FormCreate(TObject *Sender)
{
	StringGrid1->FixedCols=0;
	StringGrid1->ColCount=2;
	StringGrid1->RowCount=10;
	StringGrid1->Cells[0][0] = "Data";
	StringGrid1->Cells[1][0]="Key";
	StringGrid1->Cells[0][1]="1st"; StringGrid1->Cells[1][1]="1";
	StringGrid1->Cells[0][2]="2nd"; StringGrid1->Cells[1][2]="2";
	StringGrid1->Cells[0][3]="3rd"; StringGrid1->Cells[1][3]="3";
	StringGrid1->Cells[0][4]="4th"; StringGrid1->Cells[1][4]="4";
	StringGrid1->Cells[0][5]="5th"; StringGrid1->Cells[1][5]="5";
	StringGrid1->Cells[0][6]="6th"; StringGrid1->Cells[1][6]="6";
	StringGrid1->Cells[0][7]="7th"; StringGrid1->Cells[1][7]="7";
	StringGrid1->Cells[0][8]="8th"; StringGrid1->Cells[1][8]="8";
	StringGrid1->Cells[0][9]="9th"; StringGrid1->Cells[1][9]="9";
}
//---------------------------------------------------------------------------

void __fastcall TForm1::Button1Click(TObject *Sender)
{
	TInf A;
	for (int i = 1; i <= n; i++)
	{

		A.fio = StringGrid1->Cells[0][i];

		A.key = StrToInt(StringGrid1->Cells[1][i]);
		tree = insert(tree,A);
	}

	int kl=-1;
	TreeView1->Items->Clear();
	ViewTree(tree,kl);
	TreeView1->FullExpand();
}
//---------------------------------------------------------------------------

void __fastcall TForm1::Button2Click(TObject *Sender)
{
	tree = Delete_Node_BinaryTree(tree,StrToInt(Edit1->Text));

	int kl=-1;

	TreeView1->Items->Clear();

	ViewTree(tree,kl);

	TreeView1->FullExpand();

	for (int i = 0; i < n; i++) {
		if (StrToInt(Edit1->Text) == StringGrid1->Cells[1][i+1]) {
		  ((TExtStringGrid*)StringGrid1)->DeleteRow(i+1);
		  n--;
		}
	}

}
//---------------------------------------------------------------------------

void __fastcall TForm1::Button3Click(TObject *Sender)
{
	TInf A;
	A.fio = Edit2->Text;

	A.key = StrToInt(Edit3->Text);
	tree = insert(tree,A);
	n++;

	StringGrid1->RowCount = n+1;
	StringGrid1->Cells[0][n] = A.fio;
	StringGrid1->Cells[1][n] = A.key;
	int kl=-1;
	TreeView1->Items->Clear();
	ViewTree(tree,kl);
	TreeView1->FullExpand();

}
//---------------------------------------------------------------------------


void __fastcall TForm1::Button4Click(TObject *Sender)
{
	Memo1->Clear();

    Search(tree, StrToInt(Edit1->Text));
}
//---------------------------------------------------------------------------

